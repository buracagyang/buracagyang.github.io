<!doctype html>
<html lang="cn"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>【Spark】分类和回归算法-回归 - Hexo</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="Hexo"><meta name="msapplication-TileImage" content="/img/favicon.svg"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="Hexo"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="本节主要讲Spark ML中关于回归算法的实现。示例的算法Demo包含：线性回归、广义线性回归、决策树回归、随机森林回归、梯度提升树回归等。"><meta property="og:type" content="blog"><meta property="og:title" content="【Spark】分类和回归算法-回归"><meta property="og:url" content="http://example.com/2019/08/07/spark-classification-and-regression-2/"><meta property="og:site_name" content="Hexo"><meta property="og:description" content="本节主要讲Spark ML中关于回归算法的实现。示例的算法Demo包含：线性回归、广义线性回归、决策树回归、随机森林回归、梯度提升树回归等。"><meta property="og:locale" content="cn"><meta property="og:image" content="http://example.com/img/og_image.png"><meta property="article:published_time" content="2019-08-07T02:01:34.000Z"><meta property="article:modified_time" content="2019-08-07T07:03:42.000Z"><meta property="article:author" content="Buracag"><meta property="article:tag" content="技术备忘"><meta property="article:tag" content="大数据"><meta property="twitter:card" content="summary"><meta property="twitter:image:src" content="http://example.com/img/og_image.png"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"http://example.com/2019/08/07/spark-classification-and-regression-2/"},"headline":"【Spark】分类和回归算法-回归","image":["http://example.com/img/og_image.png"],"datePublished":"2019-08-07T02:01:34.000Z","dateModified":"2019-08-07T07:03:42.000Z","author":{"@type":"Person","name":"Buracag"},"publisher":{"@type":"Organization","name":"Hexo","logo":{"@type":"ImageObject","url":"http://example.com/img/logo.svg"}},"description":"本节主要讲Spark ML中关于回归算法的实现。示例的算法Demo包含：线性回归、广义线性回归、决策树回归、随机森林回归、梯度提升树回归等。"}</script><link rel="canonical" href="http://example.com/2019/08/07/spark-classification-and-regression-2/"><link rel="icon" href="/img/favicon.svg"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v6.0.0/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/css/justifiedGallery.min.css"><!--!--><!--!--><!--!--><style>.pace{-webkit-pointer-events:none;pointer-events:none;-webkit-user-select:none;-moz-user-select:none;user-select:none}.pace-inactive{display:none}.pace .pace-progress{background:#3273dc;position:fixed;z-index:2000;top:0;right:100%;width:100%;height:2px}</style><script src="https://cdn.jsdelivr.net/npm/pace-js@1.2.4/pace.min.js"></script><!--!--><!--!--><!-- hexo injector head_end start --><script>
  (function () {
      function switchTab() {
          if (!location.hash) {
            return;
          }

          const $tabMenu = document.querySelector(`a[href="${location.hash}"]`);
          if (!$tabMenu) {
            return;
          }

          const $tabMenuContainer = $tabMenu.parentElement.parentElement;
          Array.from($tabMenuContainer.children).forEach($menu => $menu.classList.remove('is-active'));
          Array.from($tabMenuContainer.querySelectorAll('a'))
              .map($menu => document.getElementById($menu.getAttribute("href").substring(1)))
              .forEach($content => $content.classList.add('is-hidden'));

          if ($tabMenu) {
              $tabMenu.parentElement.classList.add('is-active');
          }
          const $activeTab = document.querySelector(location.hash);
          if ($activeTab) {
              $activeTab.classList.remove('is-hidden');
          }
      }
      switchTab();
      window.addEventListener('hashchange', switchTab, false);
  })();
  </script><!-- hexo injector head_end end --><meta name="generator" content="Hexo 6.3.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container navbar-container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">Home</a><a class="navbar-item" href="/archives">Archives</a><a class="navbar-item" href="/categories">Categories</a><a class="navbar-item" href="/tags">Tags</a><a class="navbar-item" href="/about">About</a></div><div class="navbar-end"><a class="navbar-item" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a><a class="navbar-item is-hidden-tablet catalogue" title="Katalog" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="Suche" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-8-desktop is-8-widescreen"><div class="card"><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item">Gepostet vor&nbsp;<time dateTime="2019-08-07T02:01:34.000Z" title="2019/8/7 10:01:34">2019-08-07</time></span><span class="level-item">Aktualisiert vor&nbsp;<time dateTime="2019-08-07T07:03:42.000Z" title="2019/8/7 15:03:42">2019-08-07</time></span><span class="level-item">21 minutes lesen (Über 3187 Wörter)</span></div></div><h1 class="title is-3 is-size-4-mobile">【Spark】分类和回归算法-回归</h1><div class="content"><p>本节主要讲Spark ML中关于回归算法的实现。示例的算法Demo包含：线性回归、广义线性回归、决策树回归、随机森林回归、梯度提升树回归等。</p>
<span id="more"></span>
<h1 id="1-线性回归-Linear-regression"><a href="#1-线性回归-Linear-regression" class="headerlink" title="1. 线性回归(Linear regression)"></a>1. 线性回归(Linear regression)</h1><p>与logistic regression类似的，直接附上示例代码吧：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 10:11</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : linear_regression_with_elastic_net.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> LinearRegression</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;LinearRegressionWithElasticNet&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    training = spark.read.<span class="built_in">format</span>(<span class="string">&quot;libsvm&quot;</span>).load(<span class="string">&quot;../data/mllib/sample_linear_regression_data.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    lr = LinearRegression(maxIter=<span class="number">20</span>, regParam=<span class="number">0.01</span>, elasticNetParam=<span class="number">0.6</span>)</span><br><span class="line">    lrModel = lr.fit(training)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 参数和截距项</span></span><br><span class="line">    <span class="comment"># print(&quot;Coefficients: %s&quot; % str(lrModel.coefficients))</span></span><br><span class="line">    <span class="comment"># print(&quot;Intercept: %s&quot; % str(lrModel.intercept))</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 模型评估指标</span></span><br><span class="line">    trainingSummary = lrModel.summary</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;numIterations: %d&quot;</span> % trainingSummary.totalIterations)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;objectiveHistory: %s&quot;</span> % <span class="built_in">str</span>(trainingSummary.objectiveHistory))</span><br><span class="line">    trainingSummary.residuals.show()</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;RMSE: %f&quot;</span> % trainingSummary.rootMeanSquaredError)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;r2: %f&quot;</span> % trainingSummary.r2)</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果如下($r^2$如此低。。。。)：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">numIterations: 8</span><br><span class="line">objectiveHistory: [0.49999999999999994, 0.4931849471651455, 0.4863393782275527, 0.48633557300904495, 0.48633543657045664, 0.4863354337756586, 0.4863354337094886, 0.4863354337092549]</span><br><span class="line">+-------------------+</span><br><span class="line">|          residuals|</span><br><span class="line">+-------------------+</span><br><span class="line">|  -10.9791066152217|</span><br><span class="line">| 0.9208605107751258|</span><br><span class="line">| -4.608888656779226|</span><br><span class="line">|-20.424003572582702|</span><br><span class="line">|-10.316545030639608|</span><br><span class="line">+-------------------+</span><br><span class="line">only showing top 5 rows</span><br><span class="line"></span><br><span class="line">RMSE: 10.163110</span><br><span class="line">r2: 0.027836</span><br></pre></td></tr></table></figure>
<h1 id="2-广义线性回归-Generalized-linear-regression"><a href="#2-广义线性回归-Generalized-linear-regression" class="headerlink" title="2. 广义线性回归(Generalized linear regression)"></a>2. 广义线性回归(Generalized linear regression)</h1><p>与假设输出遵循高斯分布的线性回归相反，广义线性模型（GLMs）是线性模型的规范，其中响应变量$Y_i$遵循指数分布族的一些分布。 Spark的GeneralizedLinearRegression接口允许灵活地指定GLMs，可用于各种类型的预测问题，包括线性回归，泊松回归，逻辑回归等。目前在spark.ml中，仅支持指数族分布的子集，在下面列出。</p>
<div class="table-container">
<table>
<thead>
<tr>
<th>分布族</th>
<th>响应变量类型</th>
<th>Supported Links</th>
</tr>
</thead>
<tbody>
<tr>
<td>高斯分布</td>
<td>Continuous</td>
<td>Identity*,Log,Inverse</td>
</tr>
<tr>
<td>Binomial</td>
<td>二元变量</td>
<td>Logit*, Probit, CLogLog</td>
</tr>
<tr>
<td>泊松分布</td>
<td>数值</td>
<td>Log*, Identity, Sqrt</td>
</tr>
<tr>
<td>Gamma分布</td>
<td>连续变量</td>
<td>Inverse*, Identity, Log</td>
</tr>
<tr>
<td>Tweedie分布</td>
<td>zero-inflated continuous</td>
<td>Power link function</td>
</tr>
</tbody>
</table>
</div>
<p>*标准Link</p>
<p><strong>注意</strong>：Spark目前通过其GeneralizedLinearRegression接口仅支持4096个特征，如果超出此约束，则会抛出异常。尽管如此，对于线性回归和逻辑回归，可以使用LinearRegression和LogisticRegression估计来训练具有更多特征的模型(对于高纬特征集没啥用。。。)。</p>
<p>GLMs需要指数族分布，这些分布可以用“标准(canonical)”或“自然(natural)”形式写成，也就是自然指数族分布。自然指数分布族(natural exponential family distribution)的形式如下：</p>
<script type="math/tex; mode=display">
f_Y(y|\theta, \tau) = h(y, \tau)exp(\frac{\theta.y - A(\theta)}{d(\tau)}) \tag{1}</script><p>其中$\theta$是parameter of interest，$\tau$是dispersion parameter。 在GLMs中，假设响应变量$Y_i$是从自然指数分布族中提取的：</p>
<script type="math/tex; mode=display">
Y_i \sim f(\cdot|\theta_i, \tau) \tag{2}</script><p>其中，parameter of interest $\theta_i$与响应变量的期望值$\mu_i$相关:</p>
<script type="math/tex; mode=display">
\mu_i = A'(\theta_i) \tag{3}</script><p>这里，$A’(\theta_i)$根据选择的分布形式定义，GLMs还支持指定的链接函数(link function)，该函数定义响应变量的期望值$\mu_i$与线性预测值$\eta_i$之间的关系：</p>
<script type="math/tex; mode=display">
g(\mu_i) = \eta_i = \vec{x_i}^T \cdot \vec{\beta} \tag{4}</script><p>通常，选择链接函数(link function)使得$A’ =  g^{-1}$，其产生的parameter of interest $θ$与线性预测值$\eta$之间的简化关系。 在这种情况下，链接函数$g(μ)$被称为“标准”(“canonical”)链接函数。</p>
<script type="math/tex; mode=display">
\theta_i = A'^{-1}(\mu_i) = g(g^{-1}(\eta_i)) = \eta_i \tag{5}</script><p>一个GLM根据最大化似然概率函数值寻找回归系数$\vec{\beta}$:</p>
<script type="math/tex; mode=display">
\max_{\vec{\beta}} \mathcal{L}(\vec{\theta}|\vec{y},X) =
\prod_{i=1}^{N} h(y_i, \tau) \exp{\left(\frac{y_i\theta_i - A(\theta_i)}{d(\tau)}\right)} \tag{6}</script><p>其中the parameter of interest $\theta_i$与回归系数$\vec{\beta}$的关系为：</p>
<script type="math/tex; mode=display">
\theta_i = A'^{-1}(g^{-1}(\vec{x_i} \cdot \vec{\beta})) \tag{7}</script><p>示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 13:12</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : generalized_linear_regression_example.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> GeneralizedLinearRegression</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;GeneralizedLinearRegressionExample&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    dataset = spark.read.<span class="built_in">format</span>(<span class="string">&quot;libsvm&quot;</span>).load(<span class="string">&quot;../data/mllib/sample_linear_regression_data.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    glr = GeneralizedLinearRegression(family=<span class="string">&quot;gaussian&quot;</span>, link=<span class="string">&quot;identity&quot;</span>, maxIter=<span class="number">10</span>, regParam=<span class="number">0.3</span>)</span><br><span class="line">    model = glr.fit(dataset)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 参数和截距项</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Coefficients: &quot;</span> + <span class="built_in">str</span>(model.coefficients))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Intercept: &quot;</span> + <span class="built_in">str</span>(model.intercept))</span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 通不过模型检验啊...</span></span><br><span class="line">    summary = model.summary</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Coefficient Standard Errors: &quot;</span> + <span class="built_in">str</span>(summary.coefficientStandardErrors))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;T Values: &quot;</span> + <span class="built_in">str</span>(summary.tValues))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;P Values: &quot;</span> + <span class="built_in">str</span>(summary.pValues))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Dispersion: &quot;</span> + <span class="built_in">str</span>(summary.dispersion))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Null Deviance: &quot;</span> + <span class="built_in">str</span>(summary.nullDeviance))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Residual Degree Of Freedom Null: &quot;</span> + <span class="built_in">str</span>(summary.residualDegreeOfFreedomNull))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Deviance: &quot;</span> + <span class="built_in">str</span>(summary.deviance))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Residual Degree Of Freedom: &quot;</span> + <span class="built_in">str</span>(summary.residualDegreeOfFreedom))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;AIC: &quot;</span> + <span class="built_in">str</span>(summary.aic))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Deviance Residuals: &quot;</span>)</span><br><span class="line">    summary.residuals().show()</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h1 id="3-决策树回归-Decision-tree-regression"><a href="#3-决策树回归-Decision-tree-regression" class="headerlink" title="3. 决策树回归(Decision tree regression)"></a>3. 决策树回归(Decision tree regression)</h1><p>与决策树分类类似，直接附上示例代码：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 13:57</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : decision_tree_regression_example.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.ml <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> DecisionTreeRegressor</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.feature <span class="keyword">import</span> VectorIndexer</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.evaluation <span class="keyword">import</span> RegressionEvaluator</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;DecisionTreeRegressionExample&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    data = spark.read.<span class="built_in">format</span>(<span class="string">&quot;libsvm&quot;</span>).load(<span class="string">&quot;../data/mllib/sample_libsvm_data.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 自动识别分类特性，并对它们进行索引。指定maxCategories，这样存在 &gt; 4个不同值的特征将被视为连续的。</span></span><br><span class="line">    featureIndexer = VectorIndexer(inputCol=<span class="string">&quot;features&quot;</span>, outputCol=<span class="string">&quot;indexedFeatures&quot;</span>, maxCategories=<span class="number">4</span>).fit(data)</span><br><span class="line">    (trainingData, testData) = data.randomSplit([<span class="number">0.7</span>, <span class="number">0.3</span>], seed=<span class="number">2019</span>)</span><br><span class="line">    dt = DecisionTreeRegressor(featuresCol=<span class="string">&quot;indexedFeatures&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过Pipeline进行训练</span></span><br><span class="line">    pipeline = Pipeline(stages=[featureIndexer, dt])</span><br><span class="line"></span><br><span class="line">    model = pipeline.fit(trainingData)</span><br><span class="line">    predictions = model.transform(testData)</span><br><span class="line"></span><br><span class="line">    predictions.select(<span class="string">&quot;prediction&quot;</span>, <span class="string">&quot;label&quot;</span>, <span class="string">&quot;features&quot;</span>).show(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    evaluator = RegressionEvaluator(labelCol=<span class="string">&quot;label&quot;</span>, predictionCol=<span class="string">&quot;prediction&quot;</span>, metricName=<span class="string">&quot;rmse&quot;</span>)</span><br><span class="line">    rmse = evaluator.evaluate(predictions)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Root Mean Squared Error (RMSE) on test data = %g&quot;</span> % rmse)</span><br><span class="line"></span><br><span class="line">    treeModel = model.stages[<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(treeModel)</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+----------+-----+--------------------+</span><br><span class="line">|prediction|label|            features|</span><br><span class="line">+----------+-----+--------------------+</span><br><span class="line">|       0.0|  0.0|(692,[100,101,102...|</span><br><span class="line">|       0.0|  0.0|(692,[121,122,123...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">+----------+-----+--------------------+</span><br><span class="line">only showing top 5 rows</span><br><span class="line"></span><br><span class="line">Root Mean Squared Error (RMSE) on <span class="built_in">test</span> data = 0.297044</span><br><span class="line">DecisionTreeRegressionModel (uid=DecisionTreeRegressor_4089a3fc367ac7a943d9) of depth 2 with 5 nodes</span><br></pre></td></tr></table></figure>
<h1 id="4-随机森林回归-Random-forest-regression"><a href="#4-随机森林回归-Random-forest-regression" class="headerlink" title="4. 随机森林回归(Random forest regression)"></a>4. 随机森林回归(Random forest regression)</h1><p>与决策树回归类似，示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 14:05</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : random_forest_regressor_example.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.ml <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> RandomForestRegressor</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.feature <span class="keyword">import</span> VectorIndexer</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.evaluation <span class="keyword">import</span> RegressionEvaluator</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;RandomForestRegressorExample&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    data = spark.read.<span class="built_in">format</span>(<span class="string">&quot;libsvm&quot;</span>).load(<span class="string">&quot;../data/mllib/sample_libsvm_data.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 自动识别分类特性，并对它们进行索引。指定maxCategories，这样存在 &gt; 4个不同值的特征将被视为连续的。</span></span><br><span class="line">    featureIndexer = VectorIndexer(inputCol=<span class="string">&quot;features&quot;</span>, outputCol=<span class="string">&quot;indexedFeatures&quot;</span>, maxCategories=<span class="number">4</span>).fit(data)</span><br><span class="line">    (trainingData, testData) = data.randomSplit([<span class="number">0.7</span>, <span class="number">0.3</span>], seed=<span class="number">2019</span>)</span><br><span class="line">    rf = RandomForestRegressor(featuresCol=<span class="string">&quot;indexedFeatures&quot;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过Pipeline进行训练</span></span><br><span class="line">    pipeline = Pipeline(stages=[featureIndexer, rf])</span><br><span class="line">    model = pipeline.fit(trainingData)</span><br><span class="line"></span><br><span class="line">    predictions = model.transform(testData)</span><br><span class="line"></span><br><span class="line">    predictions.select(<span class="string">&quot;prediction&quot;</span>, <span class="string">&quot;label&quot;</span>, <span class="string">&quot;features&quot;</span>).show(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    evaluator = RegressionEvaluator(labelCol=<span class="string">&quot;label&quot;</span>, predictionCol=<span class="string">&quot;prediction&quot;</span>, metricName=<span class="string">&quot;rmse&quot;</span>)</span><br><span class="line">    rmse = evaluator.evaluate(predictions)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Root Mean Squared Error (RMSE) on test data = %g&quot;</span> % rmse)</span><br><span class="line"></span><br><span class="line">    rfModel = model.stages[<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(rfModel)</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+----------+-----+--------------------+</span><br><span class="line">|prediction|label|            features|</span><br><span class="line">+----------+-----+--------------------+</span><br><span class="line">|       0.4|  0.0|(692,[100,101,102...|</span><br><span class="line">|       0.0|  0.0|(692,[121,122,123...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">|       0.1|  0.0|(692,[124,125,126...|</span><br><span class="line">|      0.15|  0.0|(692,[124,125,126...|</span><br><span class="line">+----------+-----+--------------------+</span><br><span class="line">only showing top 5 rows</span><br><span class="line"></span><br><span class="line">Root Mean Squared Error (RMSE) on <span class="built_in">test</span> data = 0.141421</span><br><span class="line">RandomForestRegressionModel (uid=RandomForestRegressor_4dc1b1ad32480cc89ddc) with 20 trees</span><br></pre></td></tr></table></figure>
<h1 id="5-梯度提升树回归-Gradient-boosted-tree-regression"><a href="#5-梯度提升树回归-Gradient-boosted-tree-regression" class="headerlink" title="5. 梯度提升树回归(Gradient-boosted tree regression)"></a>5. 梯度提升树回归(Gradient-boosted tree regression)</h1><p>示例代码如下(需要注意的是，对于这个示例样本集，GBTRegressor只需要一次迭代，但是在通常情况下是不止一次的~)：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 14:11</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : gradient_boosted_tree_regressor_example.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.ml <span class="keyword">import</span> Pipeline</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> GBTRegressor</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.feature <span class="keyword">import</span> VectorIndexer</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.evaluation <span class="keyword">import</span> RegressionEvaluator</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;GradientBoostedTreeRegressorExample&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    data = spark.read.<span class="built_in">format</span>(<span class="string">&quot;libsvm&quot;</span>).load(<span class="string">&quot;../data/mllib/sample_libsvm_data.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    featureIndexer = VectorIndexer(inputCol=<span class="string">&quot;features&quot;</span>, outputCol=<span class="string">&quot;indexedFeatures&quot;</span>, maxCategories=<span class="number">4</span>).fit(data)</span><br><span class="line">    (trainingData, testData) = data.randomSplit([<span class="number">0.7</span>, <span class="number">0.3</span>], seed=<span class="number">2019</span>)</span><br><span class="line">    gbt = GBTRegressor(featuresCol=<span class="string">&quot;indexedFeatures&quot;</span>, maxIter=<span class="number">10</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 通过Pipeline进行训练</span></span><br><span class="line">    pipeline = Pipeline(stages=[featureIndexer, gbt])</span><br><span class="line">    model = pipeline.fit(trainingData)</span><br><span class="line"></span><br><span class="line">    predictions = model.transform(testData)</span><br><span class="line"></span><br><span class="line">    predictions.select(<span class="string">&quot;prediction&quot;</span>, <span class="string">&quot;label&quot;</span>, <span class="string">&quot;features&quot;</span>).show(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    evaluator = RegressionEvaluator(labelCol=<span class="string">&quot;label&quot;</span>, predictionCol=<span class="string">&quot;prediction&quot;</span>, metricName=<span class="string">&quot;rmse&quot;</span>)</span><br><span class="line">    rmse = evaluator.evaluate(predictions)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Root Mean Squared Error (RMSE) on test data = %g&quot;</span> % rmse)</span><br><span class="line"></span><br><span class="line">    gbtModel = model.stages[<span class="number">1</span>]</span><br><span class="line">    <span class="built_in">print</span>(gbtModel)</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">+----------+-----+--------------------+</span><br><span class="line">|prediction|label|            features|</span><br><span class="line">+----------+-----+--------------------+</span><br><span class="line">|       0.0|  0.0|(692,[100,101,102...|</span><br><span class="line">|       0.0|  0.0|(692,[121,122,123...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">|       0.0|  0.0|(692,[124,125,126...|</span><br><span class="line">+----------+-----+--------------------+</span><br><span class="line">only showing top 5 rows</span><br><span class="line"></span><br><span class="line">Root Mean Squared Error (RMSE) on <span class="built_in">test</span> data = 0.297044</span><br><span class="line">GBTRegressionModel (uid=GBTRegressor_46239bc64cc2f59b1fb5) with 10 trees</span><br></pre></td></tr></table></figure>
<h1 id="6-生存回归-Survival-regression"><a href="#6-生存回归-Survival-regression" class="headerlink" title="6. 生存回归(Survival regression)"></a>6. 生存回归(Survival regression)</h1><p>在spark.ml中，实现了加速失败时间（Accelerated failure time, AFT）模型，它是一个用于删失数据的参数生存回归模型（survival regression model）。 它描述了生存时间对数的模型，因此它通常被称为生存分析的对数线性模型。 与为相同目的设计的比例风险模型不同，AFT模型更易于并行化，因为每个实例都独立地为目标函数做出贡献。</p>
<p>给定协变量$x’$的值，对于受试者$i = 1，…，n$的随机寿命$t_i$(random lifetime)，可能进行右截尾(right-censoring)，AFT模型下的似然函数如下：</p>
<script type="math/tex; mode=display">
L(\beta,\sigma)=\prod_{i=1}^n[\frac{1}{\sigma}f_{0}(\frac{\log{t_{i}}-x^{'}\beta}{\sigma})]^{\delta_{i}}S_{0}(\frac{\log{t_{i}}-x^{'}\beta}{\sigma})^{1-\delta_{i}} \tag{8}</script><p>其中$\delta_i$是事件发生的指标，即是否经过截尾的。 使用$\epsilon_{i}=\frac{\log{t_{i}}-x^{‘}\beta}{\sigma}$，对数似然函数采用以下形式：</p>
<script type="math/tex; mode=display">
\iota(\beta,\sigma)=\sum_{i=1}^{n}[-\delta_{i}\log\sigma+\delta_{i}\log{f_{0}}(\epsilon_{i})+(1-\delta_{i})\log{S_{0}(\epsilon_{i})}] \tag{9}</script><p>其中$S_{0}(\epsilon_{i})$是幸存函数基线，$f_{0}(\epsilon_{i})$是相应的密度函数。</p>
<p>最常用的AFT模型基于Weibull分布的生存时间。 生命周期的Weibull分布对应于生命日志的极值分布(the extreme value distribution for the log of the lifetime)，$S_{0}(\epsilon)$函数是：</p>
<script type="math/tex; mode=display">
S_{0}(\epsilon_{i})=\exp(-e^{\epsilon_{i}}) \tag{10}</script><p>其中$f_{0}(\epsilon_{i})$函数形式为：</p>
<script type="math/tex; mode=display">
f_{0}(\epsilon_{i})=e^{\epsilon_{i}}\exp(-e^{\epsilon_{i}}) \tag{11}</script><p>带有Weibull生命分布的AFT模型的对数似然函数是：</p>
<script type="math/tex; mode=display">
\iota(\beta,\sigma)= -\sum_{i=1}^n[\delta_{i}\log\sigma-\delta_{i}\epsilon_{i}+e^{\epsilon_{i}}] \tag{12}</script><p>由于最小化负对数似然函数等效于最大化后验概率的，我们用于优化的损失函数是$-\iota(\beta,\sigma)$。 $\beta$和$\log\sigma$的梯度函数分别为：</p>
<script type="math/tex; mode=display">
\begin{eqnarray}
\frac{\partial (-\iota)}{\partial \beta} &=& \sum_{1=1}^{n}[\delta_{i}-e^{\epsilon_{i}}]\frac{x_{i}}{\sigma} \\
\frac{\partial (-\iota)}{\partial (\log\sigma)} &=& \sum_{i=1}^{n}[\delta_{i}+(\delta_{i}-e^{\epsilon_{i}})\epsilon_{i}]
\end{eqnarray} \tag{13}</script><p>AFT模型可以被转换为凸优化问题，即，找到取决于系数向量$\beta$和尺度参数的对数$\log\sigma$的凸函数的最小化的任务$-\iota(\beta,\sigma)$。 实现的优化算法是L-BFGS。 实现匹配R的生存函数的<a target="_blank" rel="noopener" href="https://stat.ethz.ch/R-manual/R-devel/library/survival/html/survreg.html">幸存结果</a>。</p>
<blockquote>
<p>当拟合AFTSurvivalRegressionModel而不截断具有常量非零列的数据集时，Spark MLlib为常量非零列输出零系数。 此与R survival :: survreg不同</p>
</blockquote>
<p>示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 14:38</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : aft_survival_regression.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> AFTSurvivalRegression</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.linalg <span class="keyword">import</span> Vectors</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;AFTSurvivalRegressionExample&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    training = spark.createDataFrame([</span><br><span class="line">        (<span class="number">1.218</span>, <span class="number">1.0</span>, Vectors.dense(<span class="number">1.560</span>, -<span class="number">0.605</span>)),</span><br><span class="line">        (<span class="number">2.949</span>, <span class="number">0.0</span>, Vectors.dense(<span class="number">0.346</span>, <span class="number">2.158</span>)),</span><br><span class="line">        (<span class="number">3.627</span>, <span class="number">0.0</span>, Vectors.dense(<span class="number">1.380</span>, <span class="number">0.231</span>)),</span><br><span class="line">        (<span class="number">0.273</span>, <span class="number">1.0</span>, Vectors.dense(<span class="number">0.520</span>, <span class="number">1.151</span>)),</span><br><span class="line">        (<span class="number">4.199</span>, <span class="number">0.0</span>, Vectors.dense(<span class="number">0.795</span>, -<span class="number">0.226</span>))], [<span class="string">&quot;label&quot;</span>, <span class="string">&quot;censor&quot;</span>, <span class="string">&quot;features&quot;</span>])</span><br><span class="line">    quantileProbabilities = [<span class="number">0.3</span>, <span class="number">0.6</span>]</span><br><span class="line">    aft = AFTSurvivalRegression(quantileProbabilities=quantileProbabilities, quantilesCol=<span class="string">&quot;quantiles&quot;</span>)</span><br><span class="line"></span><br><span class="line">    model = aft.fit(training)</span><br><span class="line"></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Coefficients: &quot;</span> + <span class="built_in">str</span>(model.coefficients))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Intercept: &quot;</span> + <span class="built_in">str</span>(model.intercept))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Scale: &quot;</span> + <span class="built_in">str</span>(model.scale))</span><br><span class="line">    model.transform(training).show(truncate=<span class="literal">False</span>)</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">Coefficients: [-0.49631114666506776,0.1984443769993409]</span><br><span class="line">Intercept: 2.6380946151</span><br><span class="line">Scale: 1.54723455744</span><br><span class="line">+-----+------+--------------+-----------------+---------------------------------------+</span><br><span class="line">|label|censor|features      |prediction       |quantiles                              |</span><br><span class="line">+-----+------+--------------+-----------------+---------------------------------------+</span><br><span class="line">|1.218|1.0   |[1.56,-0.605] |5.718979487634966|[1.1603238947151588,4.995456010274735] |</span><br><span class="line">|2.949|0.0   |[0.346,2.158] |18.07652118149563|[3.667545845471802,15.789611866277884] |</span><br><span class="line">|3.627|0.0   |[1.38,0.231]  |7.381861804239103|[1.4977061305190853,6.447962612338967] |</span><br><span class="line">|0.273|1.0   |[0.52,1.151]  |13.57761250142538|[2.7547621481507067,11.859872224069784]|</span><br><span class="line">|4.199|0.0   |[0.795,-0.226]|9.013097744073846|[1.8286676321297735,7.872826505878384] |</span><br><span class="line">+-----+------+--------------+-----------------+---------------------------------------+</span><br></pre></td></tr></table></figure>
<h1 id="7-Isotonic-regression"><a href="#7-Isotonic-regression" class="headerlink" title="7. Isotonic regression"></a>7. Isotonic regression</h1><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Isotonic_regression">Isotonic regression</a>属于回归算法族。 对 isotonic regression定义如下，给定一组有限的实数$Y = {y_1, y_2, …, y_n}$表示观察到的响应，$X = {x_1, x_2, …, x_n}$表示未知的响应值，拟合一个函数以最小化：</p>
<script type="math/tex; mode=display">
f(x) = \sum_{i=1}^n w_i (y_i - x_i)^2 \tag{14}</script><p>以$x_1\le x_2\le …\le x_n$为完整的顺序，其中$w_i$是正权重。 由此产生的函数称为isotonic regression，它是独一无二的。 它可以被视为有顺序限制下的最小二乘问题。 基本上isotonic regression是最适合原始数据点的单调函数。</p>
<p>Spark实现了一个相邻违规算法的池，该算法使用一种并行化isotonic regression的方法。 训练输入是一个DataFrame，它包含三列标签，label, features 和 weight。 此外，IsotonicRegression算法有一个<code>isotonis</code>(默认为true)的可选参数。 表示isotonic regression是isotonic的（单调递增的）还是antitonic的（单调递减的）。</p>
<p>训练返回IsotonicRegressionModel，可用于预测已知和未知特征的标签。isotonic regression的结果被视为分段线性函数。因此预测规则是：</p>
<ul>
<li>如果预测输入与训练特征完全匹配，则返回相关联的预测。如果有多个具有相同特征的预测，则返回其中一个。哪一个是未定义的（与java.util.Arrays.binarySearch相同）。</li>
<li>如果预测输入低于或高于所有训练特征，则分别返回具有最低或最高特征的预测。如果存在具有相同特征的多个预测，则分别返回最低或最高。</li>
<li>如果预测输入落在两个训练特征之间，则将预测视为分段线性函数，并且根据两个最接近特征的预测来计算内插值。如果存在具有相同特征的多个值，则使用与先前点相同的规则。</li>
</ul>
<p>示例代码如下：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># -*- coding: utf-8 -*-</span></span><br><span class="line"><span class="comment"># @Time     : 2019/8/7 14:56</span></span><br><span class="line"><span class="comment"># @Author   : buracagyang</span></span><br><span class="line"><span class="comment"># @File     : isotonic_regression_example.py</span></span><br><span class="line"><span class="comment"># @Software : PyCharm</span></span><br><span class="line"></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Describe:</span></span><br><span class="line"><span class="string">        </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> __future__ <span class="keyword">import</span> print_function</span><br><span class="line"><span class="keyword">from</span> pyspark.ml.regression <span class="keyword">import</span> IsotonicRegression</span><br><span class="line"><span class="keyword">from</span> pyspark.sql <span class="keyword">import</span> SparkSession</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    spark = SparkSession.builder.appName(<span class="string">&quot;IsotonicRegressionExample&quot;</span>).getOrCreate()</span><br><span class="line"></span><br><span class="line">    dataset = spark.read.<span class="built_in">format</span>(<span class="string">&quot;libsvm&quot;</span>).load(<span class="string">&quot;../data/mllib/sample_isotonic_regression_libsvm_data.txt&quot;</span>)</span><br><span class="line"></span><br><span class="line">    model = IsotonicRegression().fit(dataset)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Boundaries in increasing order: %s\n&quot;</span> % <span class="built_in">str</span>(model.boundaries))</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Predictions associated with the boundaries: %s\n&quot;</span> % <span class="built_in">str</span>(model.predictions))</span><br><span class="line"></span><br><span class="line">    model.transform(dataset).show(<span class="number">5</span>)</span><br><span class="line"></span><br><span class="line">    spark.stop()</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<p>结果如下：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">Boundaries <span class="keyword">in</span> increasing order: [0.01,0.17,0.18,0.27,0.28,0.29,0.3,0.31,0.34,0.35,0.36,0.41,0.42,0.71,0.72,0.74,0.75,0.76,0.77,0.78,0.79,0.8,0.81,0.82,0.83,0.84,0.85,0.86,0.87,0.88,0.89,1.0]</span><br><span class="line"></span><br><span class="line">Predictions associated with the boundaries: [0.15715271294117644,0.15715271294117644,0.189138196,0.189138196,0.20040796,0.29576747,0.43396226,0.5081591025000001,0.5081591025000001,0.54156043,0.5504844466666667,0.5504844466666667,0.563929967,0.563929967,0.5660377366666667,0.5660377366666667,0.56603774,0.57929628,0.64762876,0.66241713,0.67210607,0.67210607,0.674655785,0.674655785,0.73890872,0.73992861,0.84242733,0.89673636,0.89673636,0.90719021,0.9272055075,0.9272055075]</span><br><span class="line"></span><br><span class="line">+----------+--------------+-------------------+</span><br><span class="line">|     label|      features|         prediction|</span><br><span class="line">+----------+--------------+-------------------+</span><br><span class="line">|0.24579296|(1,[0],[0.01])|0.15715271294117644|</span><br><span class="line">|0.28505864|(1,[0],[0.02])|0.15715271294117644|</span><br><span class="line">|0.31208567|(1,[0],[0.03])|0.15715271294117644|</span><br><span class="line">|0.35900051|(1,[0],[0.04])|0.15715271294117644|</span><br><span class="line">|0.35747068|(1,[0],[0.05])|0.15715271294117644|</span><br><span class="line">+----------+--------------+-------------------+</span><br><span class="line">only showing top 5 rows</span><br></pre></td></tr></table></figure>
</div><div class="article-licensing box"><div class="licensing-title"><p>【Spark】分类和回归算法-回归</p><p><a href="http://example.com/2019/08/07/spark-classification-and-regression-2/">http://example.com/2019/08/07/spark-classification-and-regression-2/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>Author</h6><p>Buracag</p></div></div><div class="level-item is-narrow"><div><h6>Posted on</h6><p>2019-08-07</p></div></div><div class="level-item is-narrow"><div><h6>Updated on</h6><p>2019-08-07</p></div></div><div class="level-item is-narrow"><div><h6>Licensed under</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/%E6%8A%80%E6%9C%AF%E5%A4%87%E5%BF%98/">技术备忘</a><a class="link-muted mr-2" rel="tag" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/">大数据</a></div><div class="notification is-danger">You need to set <code>install_url</code> to use ShareThis. Please set it in <code>_config.yml</code>.</div></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">Gefällt Ihnen der Artikel? Unterstützen Sie den Autor mit</h3><div class="buttons is-centered"><a class="button donate" href="/" target="_blank" rel="noopener" data-type="afdian"><span class="icon is-small"><i class="fas fa-charging-station"></i></span><span>Afdian.net</span></a><a class="button donate" data-type="alipay"><span class="icon is-small"><i class="fab fa-alipay"></i></span><span>Alipay</span><span class="qrcode"><img src="/" alt="Alipay"></span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="buymeacoffee"><span class="icon is-small"><i class="fas fa-coffee"></i></span><span>Kauf mir einen Kaffee</span></a><a class="button donate" href="/" target="_blank" rel="noopener" data-type="patreon"><span class="icon is-small"><i class="fab fa-patreon"></i></span><span>Patreon</span></a><div class="notification is-danger">You forgot to set the <code>business</code> or <code>currency_code</code> for Paypal. Please set it in <code>_config.yml</code>.</div><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>Wechat</span><span class="qrcode"><img src="/" alt="Wechat"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2019/08/08/spark-clustering/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">【Spark】聚类分析</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2019/08/02/spark-classification-and-regression-1/"><span class="level-item">【Spark】分类和回归算法-分类</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">Kommentare</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "01500c300e5ba418887e3683bb89bac9",
            repo: "blog_comments",
            owner: "buracagyang",
            clientID: "b59e8ee91a1328df0e4b",
            clientSecret: "e8a8251bb9bd5ec9913a699734a6824bea1d6ec3",
            admin: "buracagyang",
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "last",
            
            
            enableHotKey: true,
            
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-4-desktop is-4-widescreen  order-1"><div class="card widget" data-type="profile"><div class="card-content"><nav class="level"><div class="level-item has-text-centered flex-shrink-1"><div><figure class="image is-128x128 mx-auto mb-2"><img class="avatar is-rounded" src="/img/me.png" alt="Buracag"></figure><p class="title is-size-4 is-block" style="line-height:inherit;">Buracag</p><p class="is-size-6 is-block">数据挖掘与分析工程师</p><p class="is-size-6 is-flex justify-content-center"><i class="fas fa-map-marker-alt mr-1"></i><span>SHENZHEN,CN</span></p></div></div></nav><nav class="level is-mobile"><div class="level-item has-text-centered is-marginless"><div><p class="heading">Seiten</p><a href="/archives"><p class="title">35</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Kategorien</p><a href="/categories"><p class="title">0</p></a></div></div><div class="level-item has-text-centered is-marginless"><div><p class="heading">Tags</p><a href="/tags"><p class="title">9</p></a></div></div></nav><div class="level"><a class="level-item button is-primary is-rounded" href="https://github.com/buracagyang" target="_blank" rel="noopener">Folgen</a></div><div class="level is-mobile is-multiline"><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="Github" href="https://github.com/buracagyang"><i class="fab fa-github"></i></a><a class="level-item button is-transparent is-marginless" target="_blank" rel="noopener" title="RSS" href="/atom.xml"><i class="fas fa-rss"></i></a></div></div></div><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">Katalog</h3><ul class="menu-list"><li><a class="level is-mobile" href="#1-线性回归-Linear-regression"><span class="level-left"><span class="level-item">1</span><span class="level-item">1. 线性回归(Linear regression)</span></span></a></li><li><a class="level is-mobile" href="#2-广义线性回归-Generalized-linear-regression"><span class="level-left"><span class="level-item">2</span><span class="level-item">2. 广义线性回归(Generalized linear regression)</span></span></a></li><li><a class="level is-mobile" href="#3-决策树回归-Decision-tree-regression"><span class="level-left"><span class="level-item">3</span><span class="level-item">3. 决策树回归(Decision tree regression)</span></span></a></li><li><a class="level is-mobile" href="#4-随机森林回归-Random-forest-regression"><span class="level-left"><span class="level-item">4</span><span class="level-item">4. 随机森林回归(Random forest regression)</span></span></a></li><li><a class="level is-mobile" href="#5-梯度提升树回归-Gradient-boosted-tree-regression"><span class="level-left"><span class="level-item">5</span><span class="level-item">5. 梯度提升树回归(Gradient-boosted tree regression)</span></span></a></li><li><a class="level is-mobile" href="#6-生存回归-Survival-regression"><span class="level-left"><span class="level-item">6</span><span class="level-item">6. 生存回归(Survival regression)</span></span></a></li><li><a class="level is-mobile" href="#7-Isotonic-regression"><span class="level-left"><span class="level-item">7</span><span class="level-item">7. Isotonic regression</span></span></a></li></ul></div></div><style>#toc .menu-list > li > a.is-active + .menu-list { display: block; }#toc .menu-list > li > a + .menu-list { display: none; }</style><script src="/js/toc.js" defer></script></div><div class="card widget" data-type="links"><div class="card-content"><div class="menu"><h3 class="menu-label">Links</h3><ul class="menu-list"><li><a class="level is-mobile" href="https://hexo.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Hexo</span></span><span class="level-right"><span class="level-item tag">hexo.io</span></span></a></li><li><a class="level is-mobile" href="https://bulma.io" target="_blank" rel="noopener"><span class="level-left"><span class="level-item">Bulma</span></span><span class="level-right"><span class="level-item tag">bulma.io</span></span></a></li></ul></div></div></div><!--!--><div class="card widget" data-type="recent-posts"><div class="card-content"><h3 class="menu-label">Letzte Einträge</h3><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-01-15T05:13:57.000Z">2020-01-15</time></p><p class="title"><a href="/2020/01/15/graph-embedding-struc2vec/">【Graph Embedding】struc2vec</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-01-14T05:55:09.000Z">2020-01-14</time></p><p class="title"><a href="/2020/01/14/graph-embedding-SDNE/">【Graph Embedding】SDNE</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2020-01-05T11:36:25.000Z">2020-01-05</time></p><p class="title"><a href="/2020/01/05/graph-embedding-node2vec/">【Graph Embedding】node2vec</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-12-26T08:16:26.000Z">2019-12-26</time></p><p class="title"><a href="/2019/12/26/graph-embedding-deepwalk/">【Graph Embedding】DeepWalk</a></p></div></article><article class="media"><div class="media-content"><p class="date"><time dateTime="2019-12-21T09:12:54.000Z">2019-12-21</time></p><p class="title"><a href="/2019/12/21/graph-embedding-line/">【Graph Embedding】line</a></p></div></article></div></div><div class="card widget" data-type="archives"><div class="card-content"><div class="menu"><h3 class="menu-label">Archive</h3><ul class="menu-list"><li><a class="level is-mobile" href="/archives/2020/01/"><span class="level-start"><span class="level-item">January 2020</span></span><span class="level-end"><span class="level-item tag">3</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/12/"><span class="level-start"><span class="level-item">December 2019</span></span><span class="level-end"><span class="level-item tag">2</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/08/"><span class="level-start"><span class="level-item">August 2019</span></span><span class="level-end"><span class="level-item tag">7</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/07/"><span class="level-start"><span class="level-item">July 2019</span></span><span class="level-end"><span class="level-item tag">4</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/06/"><span class="level-start"><span class="level-item">June 2019</span></span><span class="level-end"><span class="level-item tag">13</span></span></a></li><li><a class="level is-mobile" href="/archives/2019/05/"><span class="level-start"><span class="level-item">May 2019</span></span><span class="level-end"><span class="level-item tag">6</span></span></a></li></ul></div></div></div><div class="card widget" data-type="tags"><div class="card-content"><div class="menu"><h3 class="menu-label">Tags</h3><div class="field is-grouped is-grouped-multiline"><div class="control"><a class="tags has-addons" href="/tags/Embedding/"><span class="tag">Embedding</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/Python/"><span class="tag">Python</span><span class="tag">2</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9B%BE%E8%AE%A1%E7%AE%97/"><span class="tag">图计算</span><span class="tag">5</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86/"><span class="tag">基础知识</span><span class="tag">12</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E5%A4%A7%E6%95%B0%E6%8D%AE/"><span class="tag">大数据</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%8A%80%E6%9C%AF%E5%A4%87%E5%BF%98/"><span class="tag">技术备忘</span><span class="tag">28</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0/"><span class="tag">机器学习</span><span class="tag">1</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%AE%97%E6%B3%95%E5%A4%87%E5%BF%98/"><span class="tag">算法备忘</span><span class="tag">9</span></a></div><div class="control"><a class="tags has-addons" href="/tags/%E7%BB%9F%E8%AE%A1%E5%AD%A6%E8%BF%90%E7%94%A8/"><span class="tag">统计学运用</span><span class="tag">4</span></a></div></div></div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">Abonnieren Sie Updates</h3><form action="https://feedburner.google.com/fb/a/mailverify" method="post" target="popupwindow" onsubmit="window.open(&#039;https://feedburner.google.com/fb/a/mailverify?uri=&#039;,&#039;popupwindow&#039;,&#039;scrollbars=yes,width=550,height=520&#039;);return true"><input type="hidden" value="" name="uri"><input type="hidden" name="loc" value="en_US"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Abonnieren"></div></div></form></div></div></div><div class="card widget"><div class="card-content"><div class="notification is-danger">You need to set <code>client_id</code> and <code>slot_id</code> to show this AD unit. Please set it in <code>_config.yml</code>.</div></div></div><div class="card widget" data-type="subscribe-email"><div class="card-content"><div class="menu"><h3 class="menu-label">follow.it</h3><form action="" method="post" target="_blank"><div class="field has-addons"><div class="control has-icons-left is-expanded"><input class="input" name="email" type="email" placeholder="Email"><span class="icon is-small is-left"><i class="fas fa-envelope"></i></span></div><div class="control"><input class="button" type="submit" value="Abonnieren"></div></div></form></div></div></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"><img src="/img/logo.svg" alt="Hexo" height="28"></a><p class="is-size-7"><span>&copy; 2022 Buracag</span>  Powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a> &amp; <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Download on GitHub" href="https://github.com/ppoffice/hexo-theme-icarus"><i class="fab fa-github"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("cn");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="Zurück nach oben" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/cookieconsent@3.1.1/build/cookieconsent.min.js" defer></script><script>window.addEventListener("load", () => {
      window.cookieconsent.initialise({
        type: "info",
        theme: "edgeless",
        static: false,
        position: "bottom-left",
        content: {
          message: "Diese Website verwendet Cookies, um Ihre Erfahrung zu verbessern.",
          dismiss: "Verstanden!",
          allow: "Cookies zulassen",
          deny: "Ablehnen",
          link: "Mehr erfahren",
          policy: "Cookie-Richtlinie",
          href: "https://www.cookiesandyou.com/",
        },
        palette: {
          popup: {
            background: "#edeff5",
            text: "#838391"
          },
          button: {
            background: "#4b81e8"
          },
        },
      });
    });</script><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.10.0/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.8.1/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><script type="text/x-mathjax-config">MathJax.Hub.Config({
            'HTML-CSS': {
                matchFontHeight: false
            },
            SVG: {
                matchFontHeight: false
            },
            CommonHTML: {
                matchFontHeight: false
            },
            tex2jax: {
                inlineMath: [
                    ['$','$'],
                    ['\\(','\\)']
                ]
            }
        });</script><script src="https://cdn.jsdelivr.net/npm/mathjax@2.7.9/unpacked/MathJax.js?config=TeX-MML-AM_CHTML" defer></script><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="Tippen Sie etwas..."></div><a class="searchbox-close" href="javascript:;">×</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"Tippen Sie etwas...","untitled":"(Ohne Titel)","posts":"Seiten","pages":"Pages","categories":"Kategorien","tags":"Tags"});
        });</script></body></html>